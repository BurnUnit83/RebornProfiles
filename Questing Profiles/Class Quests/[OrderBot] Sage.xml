<?xml version="1.0" encoding="utf-8"?>
<!--
  Profile: Sage Quests
  Authors: DomesticWarlord86
-->
<Profile>
  <Name>Sage Quests</Name>
  <BehaviorDirectory></BehaviorDirectory>
  <Order>
  
    <!-- Lisbeth check -->
	<If condition="not LisbethPresent">
	  <LLToast message="This profile requires the BotBase Lisbeth to run."/>
	  <LLToast message="Please make sure Lisbeth is installed correctly before proceeding."/>
	  <StopBot/>
	</If>
	<If condition="LisbethPresent">
	  <Log Message="Lisbeth found. Starting profile..." />
	</If>

	<!-- GetQuestById(66098).QuestI8AH == 2-->
	<!-- Profile start here -->	
    <!-- Sage's Path -->
    <If Condition="not HasQuest(69603) and not IsQuestCompleted(69603)">
      <GetTo ZoneId="129" XYZ="-89.08726, 20, 86.35266"/>  <!-- Subzone="0" Area="Limsa Lominsa (Lower Decks)" -->
      <If Condition="IsQuestAcceptQualified(69603)">
        <LLPickupQuest QuestId="69603" NpcId="1039243"/>
        <LLSmallTalk/>
      </If>
    </If>	
    <If Condition="GetQuestStep(69603) == 1">
      <GetTo ZoneId="134" XYZ="-25.89312, 42.59772, 161.6769"/>  <!-- Subzone="179" Area="Middle La Noscea" -->
      <LLTalkTo NpcId="1039265" XYZ="-27.5426, 42.59772, 163.7445" QuestId="69603" StepId="1"/>
    </If>
    <If Condition="GetQuestStep(69603) == 255">
      <GetTo ZoneId="134" XYZ="-25.89312, 42.59772, 161.6769"/>  <!-- Subzone="179" Area="Middle La Noscea" -->
      <LLTurnIn QuestId="69603" NpcId="1039265" XYZ="-27.5426, 42.59772, 163.7445"/>			
      <LLSmallTalk/>
			<If Condition="IsQuestCompleted(69603)">
				<If Condition="not ClassName == ((ClassJobType.Sage))"> 
					<While Condition="ff14bot.Managers.InventoryManager.GetBagByInventoryBagId(ff14bot.Enums.InventoryBagId.EquippedItems)[ff14bot.Enums.EquipmentSlot.MainHand].RawItemId != 35778">
						<RunCode name="UseCoffer"/>
						<Log Message="Equipping Stonegold Milpreves" />
						<EquipWeapon ItemID="35778"/>
						<WaitTimer WaitTime="3" />
					</While>
				</If>
				<AutoInventoryEquip/>
			</If>				
    </If>
		
		<!-- Change To Sage If Not Already -->
		<If Condition="IsQuestCompleted(69603) and not ClassName == ClassJobType.Sage">	
			<ChangeClass Job="Sage" />
		</If>

    <!-- Sage's Focus -->
    <If Condition="not HasQuest(69604) and not IsQuestCompleted(69604)">
      <LisbethTravel Zone="134" Subzone="179" Position="-26.60374, 42.59772, 163.5414"/> <!-- Area="Middle La Noscea" -->
      <If Condition="IsQuestAcceptQualified(69604)">
        <LLPickupQuest QuestId="69604" NpcId="1039265"/>
        <LLSmallTalk/>
      </If>
    </If>
    <If Condition="GetQuestStep(69604) == 1">
      <GetTo ZoneId="478" XYZ="61.17835, 206.983, 46.96805"/>  <!-- Subzone="0" Area="Idyllshire" -->
      <LLTalkTo NpcId="1039244" XYZ="62.05847, 207, 49.3324" QuestId="69604" StepId="1"/>
    </If>
    <If Condition="GetQuestStep(69604) == 2">
      <GetTo ZoneId="478" XYZ="20.92411, 215.45, -105.9744"/>  <!-- Subzone="0" Area="Idyllshire" -->
      <UseObject NpcId="2011759" XYZ="20.06561, 215.4421, -108.1713" QuestId="69604" StepId="2"/>
    </If>
    <If Condition="GetQuestStep(69604) == 3">
      <GetTo ZoneId="478" XYZ="68.62286, 212.8397, -114.0495"/>  <!-- Subzone="0" Area="Idyllshire" -->
      <LLTalkTo NpcId="1039246" XYZ="71.64111, 213.0318, -110.7348" QuestId="69604" StepId="3"/>
    </If>
    <If Condition="GetQuestStep(69604) == 4">
      <GetTo ZoneId="478" XYZ="68.62286, 212.8397, -114.0495"/>  <!-- Subzone="0" Area="Idyllshire" -->
      <LLTalkTo NpcId="1039247" XYZ="68.7113, 212.8453, -109.9718" QuestId="69604" StepId="4"/>
    </If>
    <If Condition="GetQuestStep(69604) == 5">
      <LisbethTravel Zone="399" Subzone="2052" Position="-609.4623, 147.0476, 42.56373"/> <!-- Area="The Dravanian Hinterlands (West)" -->
      <LLTalkTo NpcId="1039248" XYZ="-612.2988, 146.8684, 42.4353" QuestId="69604" StepId="5"/>
    </If>
    <If Condition="GetQuestStep(69604) == 6">
      <LisbethTravel Zone="399" Subzone="2052" Position="-609.4623, 147.0476, 42.56373"/> <!-- Area="The Dravanian Hinterlands (West)" -->
      <LLToast message="Please complete the solo duty manually."/>
    </If>
    <If Condition="GetQuestStep(69604) == 7">
      <WaitWhile condition="GetQuestStep(69604) == 7"/>
    </If>		
    <If Condition="GetQuestStep(69604) == 8">
      <LisbethTravel Zone="399" Subzone="2034" Position="-613.8224, 146.8684, 44.3371"/> <!-- Area="The Dravanian Hinterlands (West)" -->
      <LLTalkTo NpcId="1039248" XYZ="-612.2988, 146.8684, 42.4353" QuestId="69604" StepId="8"/>
    </If>
    <If Condition="GetQuestStep(69604) == 255">
      <GetTo ZoneId="478" XYZ="1.865792, 211, -19.56077"/>  <!-- Subzone="2093" Area="Idyllshire" -->
      <LLTurnIn QuestId="69604" NpcId="1039249" XYZ="0.3508911, 211, -17.74628"/>
      <LLSmallTalk/>
    </If>		
		
 
  </Order>
  <GrindAreas>
  </GrindAreas>
  <CodeChunks>
		<CodeChunk Name="UseCoffer">
		<![CDATA[ 
            BagSlot coffer = InventoryManager.FilledSlots.FirstOrDefault(i => i.RawItemId == 35873);
            if (coffer != default(BagSlot))
            {
                coffer.UseItem();
                await Coroutine.Sleep(5000);
            }
		]]>
		</CodeChunk>	
  </CodeChunks>
</Profile>  